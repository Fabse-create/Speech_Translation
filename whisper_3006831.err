2026-01-23 16:47:45 - INFO - Logging to file: Runs/test_1percent/training.log
2026-01-23 16:47:45 - INFO - Starting pipeline in 'full' mode with seed=42
2026-01-23 16:47:45 - INFO - Using custom data percentage: 1.0%
2026-01-23 16:47:45 - INFO - Scaling data to 1.0% - effective percentages: embedding=0.05%, expert=0.15%, asr=1.00%
2026-01-23 16:47:45 - INFO - Resuming from existing run at Runs/full
2026-01-23 16:47:59 - INFO - [RESUME] Skipping embedding extraction - found 3215 embeddings
2026-01-23 16:47:59 - INFO - [RESUME] Skipping clustering - found labels at Runs/full/clustered/HDBSCAN_soft.json with 8 experts
2026-01-23 16:47:59 - INFO - [RESUME] Skipping gating pre-training - found checkpoint at Runs/full/gating_model/best.pt
2026-01-23 16:47:59 - INFO - [STEP 4/5] Training experts...

Assigning experts from cached embeddings:   0%|          | 0/482 [00:00<?, ?it/s]
Assigning experts from cached embeddings:   0%|          | 1/482 [00:01<12:23,  1.55s/it]
Assigning experts from cached embeddings:   0%|          | 2/482 [00:05<23:35,  2.95s/it]
Assigning experts from cached embeddings:   1%|          | 3/482 [00:09<27:03,  3.39s/it]
Assigning experts from cached embeddings:   1%|          | 4/482 [00:13<28:38,  3.60s/it]
Assigning experts from cached embeddings:   1%|          | 5/482 [00:16<28:22,  3.57s/it]
Assigning experts from cached embeddings:   1%|▏         | 7/482 [00:20<21:34,  2.73s/it]
Assigning experts from cached embeddings:   2%|▏         | 8/482 [00:24<24:38,  3.12s/it]
Assigning experts from cached embeddings:   2%|▏         | 9/482 [00:29<26:52,  3.41s/it]
Assigning experts from cached embeddings:   2%|▏         | 10/482 [00:32<27:04,  3.44s/it]
Assigning experts from cached embeddings:   2%|▏         | 11/482 [00:36<28:25,  3.62s/it]
Assigning experts from cached embeddings:   2%|▏         | 12/482 [00:40<29:46,  3.80s/it]
Assigning experts from cached embeddings:   3%|▎         | 14/482 [00:40<16:22,  2.10s/it]
Assigning experts from cached embeddings:   3%|▎         | 15/482 [00:44<19:58,  2.57s/it]
Assigning experts from cached embeddings:   3%|▎         | 16/482 [00:48<21:27,  2.76s/it]
Assigning experts from cached embeddings:   4%|▍         | 19/482 [00:52<15:09,  1.96s/it]
Assigning experts from cached embeddings:   4%|▍         | 20/482 [00:56<18:31,  2.41s/it]
Assigning experts from cached embeddings:   5%|▍         | 22/482 [01:00<17:17,  2.26s/it]
Assigning experts from cached embeddings:   5%|▌         | 25/482 [01:03<13:44,  1.80s/it]
Assigning experts from cached embeddings:   6%|▌         | 27/482 [01:08<14:39,  1.93s/it]
Assigning experts from cached embeddings:   6%|▌         | 30/482 [01:12<12:50,  1.70s/it]
Assigning experts from cached embeddings:   6%|▋         | 31/482 [01:16<15:28,  2.06s/it]
Assigning experts from cached embeddings:   7%|▋         | 32/482 [01:19<17:10,  2.29s/it]
Assigning experts from cached embeddings:   7%|▋         | 35/482 [01:23<13:49,  1.85s/it]
Assigning experts from cached embeddings:   7%|▋         | 36/482 [01:27<16:25,  2.21s/it]
Assigning experts from cached embeddings:   8%|▊         | 37/482 [01:31<18:55,  2.55s/it]
Assigning experts from cached embeddings:   8%|▊         | 38/482 [01:35<20:56,  2.83s/it]
Assigning experts from cached embeddings:   8%|▊         | 39/482 [01:39<22:59,  3.11s/it]
Assigning experts from cached embeddings:   8%|▊         | 40/482 [01:43<24:35,  3.34s/it]
Assigning experts from cached embeddings:   9%|▊         | 41/482 [01:46<24:57,  3.40s/it]
Assigning experts from cached embeddings:   9%|▉         | 43/482 [01:49<19:01,  2.60s/it]
Assigning experts from cached embeddings:   9%|▉         | 44/482 [01:53<21:16,  2.91s/it]
Assigning experts from cached embeddings:   9%|▉         | 45/482 [01:57<23:01,  3.16s/it]
Assigning experts from cached embeddings:  10%|▉         | 48/482 [02:01<16:03,  2.22s/it]
Assigning experts from cached embeddings:  10%|█         | 50/482 [02:05<14:48,  2.06s/it]
Assigning experts from cached embeddings:  11%|█         | 51/482 [02:09<17:40,  2.46s/it]
Assigning experts from cached embeddings:  11%|█         | 53/482 [02:13<16:12,  2.27s/it]
Assigning experts from cached embeddings:  11%|█▏        | 55/482 [02:16<14:57,  2.10s/it]
Assigning experts from cached embeddings:  12%|█▏        | 56/482 [02:19<16:12,  2.28s/it]
Assigning experts from cached embeddings:  12%|█▏        | 59/482 [02:23<13:10,  1.87s/it]
Assigning experts from cached embeddings:  13%|█▎        | 61/482 [02:28<13:59,  1.99s/it]
Assigning experts from cached embeddings:  13%|█▎        | 63/482 [02:32<14:04,  2.01s/it]
Assigning experts from cached embeddings:  13%|█▎        | 64/482 [02:36<16:12,  2.33s/it]
Assigning experts from cached embeddings:  14%|█▍        | 67/482 [02:40<12:56,  1.87s/it]
Assigning experts from cached embeddings:  14%|█▍        | 69/482 [02:44<13:06,  1.90s/it]
Assigning experts from cached embeddings:  15%|█▍        | 71/482 [02:47<12:51,  1.88s/it]
Assigning experts from cached embeddings:  15%|█▌        | 74/482 [02:51<10:43,  1.58s/it]
Assigning experts from cached embeddings:  16%|█▌        | 76/482 [02:55<11:33,  1.71s/it]
Assigning experts from cached embeddings:  16%|█▌        | 77/482 [02:59<14:03,  2.08s/it]
Assigning experts from cached embeddings:  16%|█▌        | 78/482 [03:02<16:00,  2.38s/it]
Assigning experts from cached embeddings:  17%|█▋        | 81/482 [03:06<12:28,  1.87s/it]
Assigning experts from cached embeddings:  17%|█▋        | 83/482 [03:10<12:50,  1.93s/it]
Assigning experts from cached embeddings:  18%|█▊        | 86/482 [03:14<11:12,  1.70s/it]
Assigning experts from cached embeddings:  18%|█▊        | 87/482 [03:18<13:13,  2.01s/it]
Assigning experts from cached embeddings:  19%|█▊        | 90/482 [03:21<10:42,  1.64s/it]
Assigning experts from cached embeddings:  19%|█▉        | 92/482 [03:25<11:28,  1.77s/it]
Assigning experts from cached embeddings:  19%|█▉        | 93/482 [03:30<14:28,  2.23s/it]
Assigning experts from cached embeddings:  20%|█▉        | 95/482 [03:34<13:45,  2.13s/it]
Assigning experts from cached embeddings:  20%|██        | 98/482 [03:38<12:01,  1.88s/it]
Assigning experts from cached embeddings:  21%|██        | 99/482 [03:42<14:01,  2.20s/it]
Assigning experts from cached embeddings:  21%|██        | 100/482 [03:46<15:45,  2.47s/it]
Assigning experts from cached embeddings:  21%|██        | 101/482 [03:49<16:51,  2.66s/it]
Assigning experts from cached embeddings:  21%|██        | 102/482 [03:52<17:43,  2.80s/it]
Assigning experts from cached embeddings:  21%|██▏       | 103/482 [03:56<19:32,  3.09s/it]
Assigning experts from cached embeddings:  22%|██▏       | 104/482 [03:59<19:21,  3.07s/it]
Assigning experts from cached embeddings:  22%|██▏       | 105/482 [04:02<17:51,  2.84s/it]
Assigning experts from cached embeddings:  22%|██▏       | 106/482 [04:05<18:38,  2.98s/it]
Assigning experts from cached embeddings:  22%|██▏       | 107/482 [04:09<20:26,  3.27s/it]
Assigning experts from cached embeddings:  23%|██▎       | 109/482 [04:13<16:25,  2.64s/it]
Assigning experts from cached embeddings:  23%|██▎       | 110/482 [04:16<17:56,  2.89s/it]
Assigning experts from cached embeddings:  23%|██▎       | 113/482 [04:20<12:17,  2.00s/it]
Assigning experts from cached embeddings:  24%|██▎       | 114/482 [04:23<13:48,  2.25s/it]
Assigning experts from cached embeddings:  24%|██▍       | 115/482 [04:27<15:34,  2.55s/it]
Assigning experts from cached embeddings:  24%|██▍       | 116/482 [04:30<17:06,  2.80s/it]
Assigning experts from cached embeddings:  24%|██▍       | 118/482 [04:34<14:33,  2.40s/it]
Assigning experts from cached embeddings:  25%|██▍       | 119/482 [04:38<16:17,  2.69s/it]
Assigning experts from cached embeddings:  25%|██▍       | 120/482 [04:41<17:37,  2.92s/it]
Assigning experts from cached embeddings:  26%|██▌       | 123/482 [04:45<12:32,  2.10s/it]
Assigning experts from cached embeddings:  26%|██▌       | 124/482 [04:49<14:13,  2.38s/it]
Assigning experts from cached embeddings:  27%|██▋       | 128/482 [04:49<06:44,  1.14s/it]
Assigning experts from cached embeddings:  27%|██▋       | 130/482 [04:52<07:23,  1.26s/it]
Assigning experts from cached embeddings:  27%|██▋       | 131/482 [04:56<09:41,  1.66s/it]
Assigning experts from cached embeddings:  28%|██▊       | 134/482 [04:59<08:35,  1.48s/it]
Assigning experts from cached embeddings:  28%|██▊       | 136/482 [05:03<08:56,  1.55s/it]
Assigning experts from cached embeddings:  29%|██▊       | 138/482 [05:06<09:16,  1.62s/it]
Assigning experts from cached embeddings:  29%|██▉       | 139/482 [05:10<11:13,  1.96s/it]
Assigning experts from cached embeddings:  29%|██▉       | 141/482 [05:14<10:55,  1.92s/it]
Assigning experts from cached embeddings:  30%|██▉       | 143/482 [05:18<10:57,  1.94s/it]
Assigning experts from cached embeddings:  30%|███       | 146/482 [05:21<09:09,  1.64s/it]
Assigning experts from cached embeddings:  30%|███       | 147/482 [05:25<10:54,  1.96s/it]
Assigning experts from cached embeddings:  31%|███       | 148/482 [05:29<12:42,  2.28s/it]
Assigning experts from cached embeddings:  31%|███       | 149/482 [05:32<14:21,  2.59s/it]
Assigning experts from cached embeddings:  31%|███▏      | 151/482 [05:36<12:56,  2.34s/it]
Assigning experts from cached embeddings:  32%|███▏      | 152/482 [05:40<14:48,  2.69s/it]
Assigning experts from cached embeddings:  32%|███▏      | 153/482 [05:44<16:25,  3.00s/it]
Assigning experts from cached embeddings:  32%|███▏      | 154/482 [05:48<17:32,  3.21s/it]
Assigning experts from cached embeddings:  32%|███▏      | 156/482 [05:52<14:02,  2.58s/it]
Assigning experts from cached embeddings:  33%|███▎      | 157/482 [05:55<14:54,  2.75s/it]
Assigning experts from cached embeddings:  33%|███▎      | 159/482 [05:59<13:03,  2.43s/it]
Assigning experts from cached embeddings:  33%|███▎      | 160/482 [06:03<14:44,  2.75s/it]
Assigning experts from cached embeddings:  34%|███▎      | 162/482 [06:06<12:47,  2.40s/it]
Assigning experts from cached embeddings:  34%|███▍      | 163/482 [06:10<14:44,  2.77s/it]
Assigning experts from cached embeddings:  34%|███▍      | 166/482 [06:10<07:40,  1.46s/it]
Assigning experts from cached embeddings:  35%|███▍      | 167/482 [06:14<10:00,  1.91s/it]
Assigning experts from cached embeddings:  35%|███▌      | 169/482 [06:19<10:28,  2.01s/it]
Assigning experts from cached embeddings:  35%|███▌      | 171/482 [06:22<10:04,  1.94s/it]
Assigning experts from cached embeddings:  36%|███▌      | 172/482 [06:26<11:51,  2.30s/it]
Assigning experts from cached embeddings:  36%|███▌      | 174/482 [06:30<11:31,  2.24s/it]
Assigning experts from cached embeddings:  37%|███▋      | 176/482 [06:35<11:04,  2.17s/it]
Assigning experts from cached embeddings:  37%|███▋      | 177/482 [06:38<12:42,  2.50s/it]
Assigning experts from cached embeddings:  37%|███▋      | 178/482 [06:43<14:41,  2.90s/it]
Assigning experts from cached embeddings:  37%|███▋      | 179/482 [06:47<16:12,  3.21s/it]
Assigning experts from cached embeddings:  37%|███▋      | 180/482 [06:51<17:25,  3.46s/it]
Assigning experts from cached embeddings:  38%|███▊      | 181/482 [06:54<17:01,  3.39s/it]
Assigning experts from cached embeddings:  38%|███▊      | 182/482 [06:59<18:08,  3.63s/it]
Assigning experts from cached embeddings:  38%|███▊      | 184/482 [07:03<14:22,  2.89s/it]
Assigning experts from cached embeddings:  39%|███▊      | 186/482 [07:06<12:31,  2.54s/it]
Assigning experts from cached embeddings:  39%|███▉      | 188/482 [07:11<11:45,  2.40s/it]
Assigning experts from cached embeddings:  39%|███▉      | 189/482 [07:15<13:23,  2.74s/it]
Assigning experts from cached embeddings:  39%|███▉      | 190/482 [07:19<14:47,  3.04s/it]
Assigning experts from cached embeddings:  40%|███▉      | 191/482 [07:23<15:35,  3.22s/it]
Assigning experts from cached embeddings:  40%|███▉      | 192/482 [07:26<15:53,  3.29s/it]
Assigning experts from cached embeddings:  40%|████      | 194/482 [07:30<13:27,  2.80s/it]
Assigning experts from cached embeddings:  40%|████      | 195/482 [07:35<14:48,  3.10s/it]
Assigning experts from cached embeddings:  41%|████      | 197/482 [07:38<12:28,  2.63s/it]
Assigning experts from cached embeddings:  41%|████▏     | 200/482 [07:43<09:42,  2.06s/it]
Assigning experts from cached embeddings:  42%|████▏     | 204/482 [07:43<05:09,  1.11s/it]
Assigning experts from cached embeddings:  43%|████▎     | 205/482 [07:47<07:03,  1.53s/it]
Assigning experts from cached embeddings:  43%|████▎     | 206/482 [07:51<09:11,  2.00s/it]
Assigning experts from cached embeddings:  43%|████▎     | 207/482 [07:55<10:38,  2.32s/it]
Assigning experts from cached embeddings:  43%|████▎     | 209/482 [07:59<09:54,  2.18s/it]
Assigning experts from cached embeddings:  44%|████▍     | 212/482 [08:03<08:09,  1.81s/it]
Assigning experts from cached embeddings:  44%|████▍     | 213/482 [08:07<10:02,  2.24s/it]
Assigning experts from cached embeddings:  45%|████▍     | 215/482 [08:11<09:32,  2.14s/it]
Assigning experts from cached embeddings:  45%|████▍     | 216/482 [08:15<11:06,  2.51s/it]
Assigning experts from cached embeddings:  45%|████▌     | 217/482 [08:19<12:21,  2.80s/it]
Assigning experts from cached embeddings:  46%|████▌     | 221/482 [08:19<05:33,  1.28s/it]
Assigning experts from cached embeddings:  46%|████▋     | 223/482 [08:26<08:10,  1.89s/it]
Assigning experts from cached embeddings:  46%|████▋     | 224/482 [08:29<09:23,  2.18s/it]
Assigning experts from cached embeddings:  47%|████▋     | 226/482 [08:32<08:29,  1.99s/it]
Assigning experts from cached embeddings:  47%|████▋     | 227/482 [08:36<09:28,  2.23s/it]
Assigning experts from cached embeddings:  48%|████▊     | 229/482 [08:39<08:33,  2.03s/it]
Assigning experts from cached embeddings:  48%|████▊     | 230/482 [08:43<09:44,  2.32s/it]
Assigning experts from cached embeddings:  48%|████▊     | 232/482 [08:47<09:14,  2.22s/it]
Assigning experts from cached embeddings:  48%|████▊     | 233/482 [08:50<10:35,  2.55s/it]
Assigning experts from cached embeddings:  49%|████▊     | 234/482 [08:54<11:15,  2.72s/it]
Assigning experts from cached embeddings:  49%|████▉     | 236/482 [08:54<06:51,  1.67s/it]
Assigning experts from cached embeddings:  49%|████▉     | 238/482 [08:57<06:38,  1.63s/it]
Assigning experts from cached embeddings:  50%|████▉     | 239/482 [09:01<08:27,  2.09s/it]
Assigning experts from cached embeddings:  50%|████▉     | 240/482 [09:05<10:02,  2.49s/it]
Assigning experts from cached embeddings:  50%|█████     | 241/482 [09:08<11:02,  2.75s/it]
Assigning experts from cached embeddings:  50%|█████     | 242/482 [09:12<12:08,  3.03s/it]
Assigning experts from cached embeddings:  50%|█████     | 243/482 [09:16<13:10,  3.31s/it]
Assigning experts from cached embeddings:  51%|█████     | 245/482 [09:20<10:37,  2.69s/it]
Assigning experts from cached embeddings:  52%|█████▏    | 249/482 [09:20<04:42,  1.21s/it]
Assigning experts from cached embeddings:  52%|█████▏    | 252/482 [09:24<04:35,  1.20s/it]
Assigning experts from cached embeddings:  53%|█████▎    | 254/482 [09:26<04:43,  1.24s/it]
Assigning experts from cached embeddings:  53%|█████▎    | 256/482 [09:30<05:23,  1.43s/it]
Assigning experts from cached embeddings:  54%|█████▍    | 260/482 [09:30<03:01,  1.22it/s]
Assigning experts from cached embeddings:  54%|█████▍    | 262/482 [09:34<04:04,  1.11s/it]
Assigning experts from cached embeddings:  55%|█████▍    | 264/482 [09:38<04:51,  1.34s/it]
Assigning experts from cached embeddings:  55%|█████▍    | 265/482 [09:42<06:01,  1.67s/it]
Assigning experts from cached embeddings:  55%|█████▌    | 267/482 [09:46<06:14,  1.74s/it]
Assigning experts from cached embeddings:  56%|█████▌    | 270/482 [09:50<05:46,  1.63s/it]
Assigning experts from cached embeddings:  56%|█████▌    | 271/482 [09:54<07:06,  2.02s/it]
Assigning experts from cached embeddings:  57%|█████▋    | 275/482 [09:57<04:59,  1.44s/it]
Assigning experts from cached embeddings:  57%|█████▋    | 276/482 [10:01<06:07,  1.78s/it]
Assigning experts from cached embeddings:  57%|█████▋    | 277/482 [10:05<07:26,  2.18s/it]
Assigning experts from cached embeddings:  58%|█████▊    | 278/482 [10:09<08:35,  2.53s/it]
Assigning experts from cached embeddings:  58%|█████▊    | 279/482 [10:13<09:47,  2.89s/it]
Assigning experts from cached embeddings:  58%|█████▊    | 280/482 [10:18<10:41,  3.18s/it]
Assigning experts from cached embeddings:  58%|█████▊    | 281/482 [10:21<11:13,  3.35s/it]
Assigning experts from cached embeddings:  59%|█████▊    | 283/482 [10:25<09:13,  2.78s/it]
Assigning experts from cached embeddings:  59%|█████▉    | 284/482 [10:29<09:42,  2.94s/it]
Assigning experts from cached embeddings:  59%|█████▉    | 286/482 [10:32<08:06,  2.48s/it]
Assigning experts from cached embeddings:  60%|█████▉    | 288/482 [10:37<07:37,  2.36s/it]
Assigning experts from cached embeddings:  60%|█████▉    | 289/482 [10:41<08:35,  2.67s/it]
Assigning experts from cached embeddings:  60%|██████    | 291/482 [10:45<07:51,  2.47s/it]
Assigning experts from cached embeddings:  61%|██████    | 292/482 [10:49<08:46,  2.77s/it]
Assigning experts from cached embeddings:  61%|██████    | 295/482 [10:53<06:37,  2.13s/it]
Assigning experts from cached embeddings:  62%|██████▏   | 298/482 [10:57<05:27,  1.78s/it]
Assigning experts from cached embeddings:  62%|██████▏   | 300/482 [11:01<05:31,  1.82s/it]
Assigning experts from cached embeddings:  62%|██████▏   | 301/482 [11:05<06:34,  2.18s/it]
Assigning experts from cached embeddings:  63%|██████▎   | 302/482 [11:09<07:42,  2.57s/it]
Assigning experts from cached embeddings:  63%|██████▎   | 304/482 [11:13<06:55,  2.34s/it]
Assigning experts from cached embeddings:  63%|██████▎   | 305/482 [11:17<08:01,  2.72s/it]
Assigning experts from cached embeddings:  63%|██████▎   | 306/482 [11:21<08:42,  2.97s/it]
Assigning experts from cached embeddings:  64%|██████▍   | 308/482 [11:25<07:33,  2.61s/it]
Assigning experts from cached embeddings:  65%|██████▍   | 311/482 [11:28<05:34,  1.95s/it]
Assigning experts from cached embeddings:  65%|██████▍   | 312/482 [11:32<06:28,  2.29s/it]
Assigning experts from cached embeddings:  65%|██████▌   | 315/482 [11:36<05:21,  1.92s/it]
Assigning experts from cached embeddings:  66%|██████▌   | 319/482 [11:41<04:06,  1.51s/it]
Assigning experts from cached embeddings:  66%|██████▋   | 320/482 [11:45<05:03,  1.87s/it]
Assigning experts from cached embeddings:  67%|██████▋   | 324/482 [11:49<03:58,  1.51s/it]
Assigning experts from cached embeddings:  67%|██████▋   | 325/482 [11:53<04:53,  1.87s/it]
Assigning experts from cached embeddings:  68%|██████▊   | 327/482 [11:57<04:54,  1.90s/it]
Assigning experts from cached embeddings:  68%|██████▊   | 328/482 [12:01<05:37,  2.19s/it]
Assigning experts from cached embeddings:  68%|██████▊   | 329/482 [12:05<06:27,  2.53s/it]
Assigning experts from cached embeddings:  69%|██████▊   | 331/482 [12:09<06:04,  2.41s/it]
Assigning experts from cached embeddings:  69%|██████▉   | 332/482 [12:13<06:47,  2.72s/it]
Assigning experts from cached embeddings:  69%|██████▉   | 333/482 [12:17<07:36,  3.07s/it]
Assigning experts from cached embeddings:  69%|██████▉   | 334/482 [12:21<08:12,  3.33s/it]
Assigning experts from cached embeddings:  70%|██████▉   | 337/482 [12:26<05:41,  2.35s/it]
Assigning experts from cached embeddings:  70%|███████   | 338/482 [12:29<06:16,  2.61s/it]
Assigning experts from cached embeddings:  70%|███████   | 339/482 [12:33<06:57,  2.92s/it]
Assigning experts from cached embeddings:  71%|███████   | 341/482 [12:38<06:09,  2.62s/it]
Assigning experts from cached embeddings:  71%|███████   | 342/482 [12:42<06:57,  2.98s/it]
Assigning experts from cached embeddings:  71%|███████▏  | 344/482 [12:46<06:12,  2.70s/it]
Assigning experts from cached embeddings:  72%|███████▏  | 345/482 [12:50<06:48,  2.98s/it]
Assigning experts from cached embeddings:  72%|███████▏  | 346/482 [12:54<07:22,  3.25s/it]
Assigning experts from cached embeddings:  72%|███████▏  | 347/482 [12:59<07:48,  3.47s/it]
Assigning experts from cached embeddings:  72%|███████▏  | 348/482 [13:02<07:51,  3.52s/it]
Assigning experts from cached embeddings:  72%|███████▏  | 349/482 [13:07<08:18,  3.75s/it]
Assigning experts from cached embeddings:  73%|███████▎  | 351/482 [13:11<06:42,  3.07s/it]
Assigning experts from cached embeddings:  73%|███████▎  | 353/482 [13:15<05:38,  2.62s/it]
Assigning experts from cached embeddings:  73%|███████▎  | 354/482 [13:19<06:19,  2.96s/it]
Assigning experts from cached embeddings:  74%|███████▍  | 356/482 [13:23<05:25,  2.58s/it]
Assigning experts from cached embeddings:  74%|███████▍  | 359/482 [13:27<04:13,  2.06s/it]
Assigning experts from cached embeddings:  75%|███████▍  | 360/482 [13:31<04:39,  2.29s/it]
Assigning experts from cached embeddings:  75%|███████▍  | 361/482 [13:35<05:25,  2.69s/it]
Assigning experts from cached embeddings:  75%|███████▌  | 362/482 [13:39<05:59,  2.99s/it]
Assigning experts from cached embeddings:  75%|███████▌  | 363/482 [13:43<06:21,  3.21s/it]
Assigning experts from cached embeddings:  76%|███████▌  | 364/482 [13:47<06:49,  3.47s/it]
Assigning experts from cached embeddings:  76%|███████▌  | 365/482 [13:51<07:07,  3.65s/it]
Assigning experts from cached embeddings:  76%|███████▌  | 366/482 [13:55<07:22,  3.81s/it]
Assigning experts from cached embeddings:  76%|███████▋  | 368/482 [13:59<05:36,  2.95s/it]
Assigning experts from cached embeddings:  77%|███████▋  | 369/482 [14:02<05:37,  2.99s/it]
Assigning experts from cached embeddings:  77%|███████▋  | 370/482 [14:06<06:01,  3.23s/it]
Assigning experts from cached embeddings:  77%|███████▋  | 373/482 [14:10<04:02,  2.23s/it]
Assigning experts from cached embeddings:  78%|███████▊  | 374/482 [14:14<04:33,  2.53s/it]
Assigning experts from cached embeddings:  78%|███████▊  | 378/482 [14:18<03:00,  1.73s/it]
Assigning experts from cached embeddings:  79%|███████▊  | 379/482 [14:22<03:31,  2.05s/it]
Assigning experts from cached embeddings:  79%|███████▉  | 380/482 [14:26<04:04,  2.40s/it]
Assigning experts from cached embeddings:  79%|███████▉  | 381/482 [14:30<04:37,  2.74s/it]
Assigning experts from cached embeddings:  79%|███████▉  | 382/482 [14:33<04:52,  2.92s/it]
Assigning experts from cached embeddings:  79%|███████▉  | 383/482 [14:37<05:12,  3.16s/it]
Assigning experts from cached embeddings:  80%|███████▉  | 385/482 [14:41<04:15,  2.63s/it]
Assigning experts from cached embeddings:  80%|████████  | 387/482 [14:44<03:36,  2.28s/it]
Assigning experts from cached embeddings:  80%|████████  | 388/482 [14:48<04:04,  2.60s/it]
Assigning experts from cached embeddings:  81%|████████  | 389/482 [14:52<04:28,  2.89s/it]
Assigning experts from cached embeddings:  81%|████████  | 390/482 [14:56<04:56,  3.22s/it]
Assigning experts from cached embeddings:  81%|████████▏ | 392/482 [15:00<03:58,  2.65s/it]
Assigning experts from cached embeddings:  82%|████████▏ | 393/482 [15:03<04:13,  2.85s/it]
Assigning experts from cached embeddings:  82%|████████▏ | 396/482 [15:03<02:05,  1.46s/it]
Assigning experts from cached embeddings:  83%|████████▎ | 398/482 [15:08<02:22,  1.69s/it]
Assigning experts from cached embeddings:  83%|████████▎ | 399/482 [15:12<02:54,  2.10s/it]
Assigning experts from cached embeddings:  83%|████████▎ | 400/482 [15:16<03:23,  2.48s/it]
Assigning experts from cached embeddings:  83%|████████▎ | 402/482 [15:20<03:07,  2.34s/it]
Assigning experts from cached embeddings:  84%|████████▎ | 403/482 [15:24<03:35,  2.73s/it]
Assigning experts from cached embeddings:  84%|████████▍ | 404/482 [15:28<03:50,  2.96s/it]
Assigning experts from cached embeddings:  84%|████████▍ | 405/482 [15:31<03:55,  3.06s/it]
Assigning experts from cached embeddings:  85%|████████▍ | 408/482 [15:31<01:50,  1.50s/it]
Assigning experts from cached embeddings:  85%|████████▍ | 409/482 [15:35<02:19,  1.90s/it]
Assigning experts from cached embeddings:  85%|████████▌ | 411/482 [15:39<02:16,  1.92s/it]
Assigning experts from cached embeddings:  85%|████████▌ | 412/482 [15:43<02:44,  2.36s/it]
Assigning experts from cached embeddings:  86%|████████▌ | 415/482 [15:46<02:03,  1.84s/it]
Assigning experts from cached embeddings:  87%|████████▋ | 418/482 [15:51<01:45,  1.66s/it]
Assigning experts from cached embeddings:  87%|████████▋ | 421/482 [15:55<01:34,  1.55s/it]
Assigning experts from cached embeddings:  88%|████████▊ | 423/482 [15:59<01:38,  1.67s/it]
Assigning experts from cached embeddings:  88%|████████▊ | 425/482 [16:02<01:36,  1.69s/it]
Assigning experts from cached embeddings:  88%|████████▊ | 426/482 [16:06<01:55,  2.06s/it]
Assigning experts from cached embeddings:  89%|████████▉ | 429/482 [16:10<01:35,  1.80s/it]
Assigning experts from cached embeddings:  89%|████████▉ | 430/482 [16:15<01:53,  2.18s/it]
Assigning experts from cached embeddings:  89%|████████▉ | 431/482 [16:18<02:07,  2.50s/it]
Assigning experts from cached embeddings:  90%|████████▉ | 432/482 [16:23<02:23,  2.87s/it]
Assigning experts from cached embeddings:  90%|████████▉ | 433/482 [16:27<02:35,  3.18s/it]
Assigning experts from cached embeddings:  90%|█████████ | 434/482 [16:31<02:43,  3.41s/it]
Assigning experts from cached embeddings:  90%|█████████ | 435/482 [16:35<02:43,  3.48s/it]
Assigning experts from cached embeddings:  91%|█████████ | 437/482 [16:39<02:09,  2.87s/it]
Assigning experts from cached embeddings:  91%|█████████▏| 440/482 [16:43<01:29,  2.14s/it]
Assigning experts from cached embeddings:  92%|█████████▏| 442/482 [16:47<01:23,  2.08s/it]
Assigning experts from cached embeddings:  92%|█████████▏| 443/482 [16:51<01:36,  2.46s/it]
Assigning experts from cached embeddings:  92%|█████████▏| 445/482 [16:55<01:28,  2.38s/it]
Assigning experts from cached embeddings:  93%|█████████▎| 448/482 [17:00<01:07,  1.98s/it]
Assigning experts from cached embeddings:  93%|█████████▎| 449/482 [17:03<01:13,  2.22s/it]
Assigning experts from cached embeddings:  93%|█████████▎| 450/482 [17:07<01:23,  2.59s/it]
Assigning experts from cached embeddings:  94%|█████████▎| 451/482 [17:11<01:29,  2.88s/it]
Assigning experts from cached embeddings:  94%|█████████▍| 452/482 [17:15<01:32,  3.09s/it]
Assigning experts from cached embeddings:  94%|█████████▍| 453/482 [17:19<01:35,  3.29s/it]
Assigning experts from cached embeddings:  95%|█████████▍| 456/482 [17:23<00:59,  2.29s/it]
Assigning experts from cached embeddings:  95%|█████████▌| 458/482 [17:27<00:53,  2.25s/it]
Assigning experts from cached embeddings:  96%|█████████▌| 461/482 [17:31<00:39,  1.87s/it]
Assigning experts from cached embeddings:  96%|█████████▌| 463/482 [17:35<00:34,  1.82s/it]
Assigning experts from cached embeddings:  96%|█████████▋| 464/482 [17:38<00:39,  2.17s/it]
Assigning experts from cached embeddings:  96%|█████████▋| 465/482 [17:43<00:43,  2.53s/it]
Assigning experts from cached embeddings:  97%|█████████▋| 469/482 [17:43<00:15,  1.22s/it]
Assigning experts from cached embeddings:  98%|█████████▊| 470/482 [17:47<00:19,  1.65s/it]
Assigning experts from cached embeddings:  98%|█████████▊| 472/482 [17:51<00:17,  1.75s/it]
Assigning experts from cached embeddings:  98%|█████████▊| 473/482 [17:55<00:19,  2.19s/it]
Assigning experts from cached embeddings:  99%|█████████▊| 475/482 [17:59<00:15,  2.19s/it]
Assigning experts from cached embeddings:  99%|█████████▉| 477/482 [18:03<00:10,  2.11s/it]
Assigning experts from cached embeddings:  99%|█████████▉| 479/482 [18:07<00:06,  2.03s/it]
Assigning experts from cached embeddings: 100%|█████████▉| 480/482 [18:11<00:04,  2.43s/it]
Assigning experts from cached embeddings: 100%|█████████▉| 481/482 [18:15<00:02,  2.85s/it]
Assigning experts from cached embeddings: 100%|██████████| 482/482 [18:15<00:00,  2.27s/it]
/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/expert_pre_training.py:508: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=config.fp16)

Expert 0 Epoch 1:   0%|          | 0/1 [00:00<?, ?it/s]/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/expert_pre_training.py:537: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=config.fp16):

Expert 0 Epoch 1: 100%|██████████| 1/1 [00:17<00:00, 17.96s/it]
                                                               

Expert 0 Epoch 2:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 0 Epoch 2: 100%|██████████| 1/1 [00:01<00:00,  1.34s/it]
                                                               

Expert 0 Epoch 3:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 0 Epoch 3: 100%|██████████| 1/1 [00:01<00:00,  1.39s/it]
                                                               

Expert 0 Epoch 4:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 0 Epoch 4: 100%|██████████| 1/1 [00:01<00:00,  1.34s/it]
                                                               

Expert 0 Epoch 5:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 0 Epoch 5: 100%|██████████| 1/1 [00:01<00:00,  1.32s/it]
                                                               

Expert 1 Epoch 1:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 1 Epoch 1: 100%|██████████| 1/1 [00:01<00:00,  1.64s/it]
                                                               

Expert 1 Epoch 2:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 1 Epoch 2: 100%|██████████| 1/1 [00:01<00:00,  1.23s/it]
                                                               

Expert 1 Epoch 3:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 1 Epoch 3: 100%|██████████| 1/1 [00:01<00:00,  1.21s/it]
                                                               

Expert 1 Epoch 4:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 1 Epoch 4: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it]
                                                               

Expert 1 Epoch 5:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 1 Epoch 5: 100%|██████████| 1/1 [00:01<00:00,  1.22s/it]
                                                               

Expert 2 Epoch 1:   0%|          | 0/2 [00:00<?, ?it/s]
Expert 2 Epoch 1:  50%|█████     | 1/2 [00:01<00:01,  1.51s/it]
Expert 2 Epoch 1: 100%|██████████| 2/2 [00:01<00:00,  1.21it/s]
                                                               

Expert 2 Epoch 2:   0%|          | 0/2 [00:00<?, ?it/s]
Expert 2 Epoch 2:  50%|█████     | 1/2 [00:01<00:01,  1.37s/it]
Expert 2 Epoch 2: 100%|██████████| 2/2 [00:01<00:00,  1.42it/s]
                                                               

Expert 2 Epoch 3:   0%|          | 0/2 [00:00<?, ?it/s]
Expert 2 Epoch 3:  50%|█████     | 1/2 [00:01<00:01,  1.33s/it]
Expert 2 Epoch 3: 100%|██████████| 2/2 [00:01<00:00,  1.43it/s]
                                                               

Expert 2 Epoch 4:   0%|          | 0/2 [00:00<?, ?it/s]
Expert 2 Epoch 4:  50%|█████     | 1/2 [00:01<00:01,  1.38s/it]
Expert 2 Epoch 4: 100%|██████████| 2/2 [00:01<00:00,  1.34it/s]
                                                               

Expert 2 Epoch 5:   0%|          | 0/2 [00:00<?, ?it/s]
Expert 2 Epoch 5:  50%|█████     | 1/2 [00:01<00:01,  1.30s/it]
Expert 2 Epoch 5: 100%|██████████| 2/2 [00:01<00:00,  1.45it/s]
                                                               

Expert 3 Epoch 1:   0%|          | 0/21 [00:00<?, ?it/s]
Expert 3 Epoch 1:   5%|▍         | 1/21 [00:01<00:29,  1.48s/it]
Expert 3 Epoch 1:  10%|▉         | 2/21 [00:01<00:15,  1.19it/s]
Expert 3 Epoch 1:  14%|█▍        | 3/21 [00:02<00:11,  1.60it/s]
Expert 3 Epoch 1:  19%|█▉        | 4/21 [00:02<00:08,  1.91it/s]
Expert 3 Epoch 1:  24%|██▍       | 5/21 [00:02<00:07,  2.14it/s]
Expert 3 Epoch 1:  29%|██▊       | 6/21 [00:03<00:06,  2.30it/s]
Expert 3 Epoch 1:  33%|███▎      | 7/21 [00:03<00:05,  2.44it/s]
Expert 3 Epoch 1:  38%|███▊      | 8/21 [00:04<00:05,  2.52it/s]
Expert 3 Epoch 1:  43%|████▎     | 9/21 [00:04<00:04,  2.58it/s]
Expert 3 Epoch 1:  48%|████▊     | 10/21 [00:04<00:04,  2.61it/s]
Expert 3 Epoch 1:  52%|█████▏    | 11/21 [00:05<00:03,  2.64it/s]
Expert 3 Epoch 1:  57%|█████▋    | 12/21 [00:05<00:03,  2.66it/s]
Expert 3 Epoch 1:  62%|██████▏   | 13/21 [00:05<00:02,  2.68it/s]
Expert 3 Epoch 1:  67%|██████▋   | 14/21 [00:06<00:02,  2.70it/s]
Expert 3 Epoch 1:  71%|███████▏  | 15/21 [00:06<00:02,  2.72it/s]
Expert 3 Epoch 1:  76%|███████▌  | 16/21 [00:07<00:01,  2.72it/s]
Expert 3 Epoch 1:  81%|████████  | 17/21 [00:07<00:01,  2.74it/s]
Expert 3 Epoch 1:  86%|████████▌ | 18/21 [00:07<00:01,  2.73it/s]
Expert 3 Epoch 1:  90%|█████████ | 19/21 [00:08<00:00,  2.73it/s]
Expert 3 Epoch 1:  95%|█████████▌| 20/21 [00:08<00:00,  2.73it/s]
Expert 3 Epoch 1: 100%|██████████| 21/21 [00:08<00:00,  2.83it/s]
                                                                 
/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/expert_pre_training.py:421: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=use_amp):
Using custom `forced_decoder_ids` from the (generation) config. This is deprecated in favor of the `task` and `language` flags/config options.
Transcription using a multilingual Whisper will default to language detection followed by transcription instead of translation to English. This might be a breaking change for your use case. If you want to instead always translate your audio to English, make sure to pass `language='en'`. See https://github.com/huggingface/transformers/pull/28687 for more details.
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.

Expert 3 Epoch 2:   0%|          | 0/21 [00:00<?, ?it/s]
Expert 3 Epoch 2:   5%|▍         | 1/21 [00:01<00:26,  1.31s/it]
Expert 3 Epoch 2:  10%|▉         | 2/21 [00:01<00:14,  1.33it/s]
Expert 3 Epoch 2:  14%|█▍        | 3/21 [00:02<00:10,  1.74it/s]
Expert 3 Epoch 2:  19%|█▉        | 4/21 [00:02<00:08,  2.03it/s]
Expert 3 Epoch 2:  24%|██▍       | 5/21 [00:02<00:07,  2.24it/s]
Expert 3 Epoch 2:  29%|██▊       | 6/21 [00:03<00:06,  2.39it/s]
Expert 3 Epoch 2:  33%|███▎      | 7/21 [00:03<00:05,  2.50it/s]
Expert 3 Epoch 2:  38%|███▊      | 8/21 [00:03<00:05,  2.56it/s]
Expert 3 Epoch 2:  43%|████▎     | 9/21 [00:04<00:04,  2.61it/s]
Expert 3 Epoch 2:  48%|████▊     | 10/21 [00:04<00:04,  2.65it/s]
Expert 3 Epoch 2:  52%|█████▏    | 11/21 [00:04<00:03,  2.69it/s]
Expert 3 Epoch 2:  57%|█████▋    | 12/21 [00:05<00:03,  2.72it/s]
Expert 3 Epoch 2:  62%|██████▏   | 13/21 [00:05<00:02,  2.73it/s]
Expert 3 Epoch 2:  67%|██████▋   | 14/21 [00:06<00:02,  2.74it/s]
Expert 3 Epoch 2:  71%|███████▏  | 15/21 [00:06<00:02,  2.74it/s]
Expert 3 Epoch 2:  76%|███████▌  | 16/21 [00:06<00:01,  2.74it/s]
Expert 3 Epoch 2:  81%|████████  | 17/21 [00:07<00:01,  2.75it/s]
Expert 3 Epoch 2:  86%|████████▌ | 18/21 [00:07<00:01,  2.73it/s]
Expert 3 Epoch 2:  90%|█████████ | 19/21 [00:07<00:00,  2.73it/s]
Expert 3 Epoch 2:  95%|█████████▌| 20/21 [00:08<00:00,  2.73it/s]
Expert 3 Epoch 2: 100%|██████████| 21/21 [00:08<00:00,  2.84it/s]
                                                                 

Expert 3 Epoch 3:   0%|          | 0/21 [00:00<?, ?it/s]
Expert 3 Epoch 3:   5%|▍         | 1/21 [00:01<00:24,  1.23s/it]
Expert 3 Epoch 3:  10%|▉         | 2/21 [00:01<00:13,  1.38it/s]
Expert 3 Epoch 3:  14%|█▍        | 3/21 [00:01<00:10,  1.79it/s]
Expert 3 Epoch 3:  19%|█▉        | 4/21 [00:02<00:08,  2.07it/s]
Expert 3 Epoch 3:  24%|██▍       | 5/21 [00:02<00:07,  2.26it/s]
Expert 3 Epoch 3:  29%|██▊       | 6/21 [00:03<00:06,  2.42it/s]
Expert 3 Epoch 3:  33%|███▎      | 7/21 [00:03<00:05,  2.51it/s]
Expert 3 Epoch 3:  38%|███▊      | 8/21 [00:03<00:05,  2.57it/s]
Expert 3 Epoch 3:  43%|████▎     | 9/21 [00:04<00:04,  2.63it/s]
Expert 3 Epoch 3:  48%|████▊     | 10/21 [00:04<00:04,  2.67it/s]
Expert 3 Epoch 3:  52%|█████▏    | 11/21 [00:04<00:03,  2.69it/s]
Expert 3 Epoch 3:  57%|█████▋    | 12/21 [00:05<00:03,  2.71it/s]
Expert 3 Epoch 3:  62%|██████▏   | 13/21 [00:05<00:02,  2.71it/s]
Expert 3 Epoch 3:  67%|██████▋   | 14/21 [00:05<00:02,  2.74it/s]
Expert 3 Epoch 3:  71%|███████▏  | 15/21 [00:06<00:02,  2.76it/s]
Expert 3 Epoch 3:  76%|███████▌  | 16/21 [00:06<00:01,  2.77it/s]
Expert 3 Epoch 3:  81%|████████  | 17/21 [00:07<00:01,  2.78it/s]
Expert 3 Epoch 3:  86%|████████▌ | 18/21 [00:07<00:01,  2.78it/s]
Expert 3 Epoch 3:  90%|█████████ | 19/21 [00:07<00:00,  2.77it/s]
Expert 3 Epoch 3:  95%|█████████▌| 20/21 [00:08<00:00,  2.76it/s]
Expert 3 Epoch 3: 100%|██████████| 21/21 [00:08<00:00,  2.88it/s]
                                                                 

Expert 3 Epoch 4:   0%|          | 0/21 [00:00<?, ?it/s]
Expert 3 Epoch 4:   5%|▍         | 1/21 [00:01<00:26,  1.33s/it]
Expert 3 Epoch 4:  10%|▉         | 2/21 [00:01<00:14,  1.31it/s]
Expert 3 Epoch 4:  14%|█▍        | 3/21 [00:02<00:10,  1.73it/s]
Expert 3 Epoch 4:  19%|█▉        | 4/21 [00:02<00:08,  2.02it/s]
Expert 3 Epoch 4:  24%|██▍       | 5/21 [00:02<00:07,  2.21it/s]
Expert 3 Epoch 4:  29%|██▊       | 6/21 [00:03<00:06,  2.36it/s]
Expert 3 Epoch 4:  33%|███▎      | 7/21 [00:03<00:05,  2.47it/s]
Expert 3 Epoch 4:  38%|███▊      | 8/21 [00:03<00:05,  2.55it/s]
Expert 3 Epoch 4:  43%|████▎     | 9/21 [00:04<00:04,  2.60it/s]
Expert 3 Epoch 4:  48%|████▊     | 10/21 [00:04<00:04,  2.64it/s]
Expert 3 Epoch 4:  52%|█████▏    | 11/21 [00:05<00:03,  2.66it/s]
Expert 3 Epoch 4:  57%|█████▋    | 12/21 [00:05<00:03,  2.68it/s]
Expert 3 Epoch 4:  62%|██████▏   | 13/21 [00:05<00:02,  2.69it/s]
Expert 3 Epoch 4:  67%|██████▋   | 14/21 [00:06<00:02,  2.71it/s]
Expert 3 Epoch 4:  71%|███████▏  | 15/21 [00:06<00:02,  2.72it/s]
Expert 3 Epoch 4:  76%|███████▌  | 16/21 [00:06<00:01,  2.73it/s]
Expert 3 Epoch 4:  81%|████████  | 17/21 [00:07<00:01,  2.75it/s]
Expert 3 Epoch 4:  86%|████████▌ | 18/21 [00:07<00:01,  2.76it/s]
Expert 3 Epoch 4:  90%|█████████ | 19/21 [00:07<00:00,  2.76it/s]
Expert 3 Epoch 4:  95%|█████████▌| 20/21 [00:08<00:00,  2.75it/s]
Expert 3 Epoch 4: 100%|██████████| 21/21 [00:08<00:00,  2.87it/s]
                                                                 

Expert 3 Epoch 5:   0%|          | 0/21 [00:00<?, ?it/s]
Expert 3 Epoch 5:   5%|▍         | 1/21 [00:01<00:26,  1.30s/it]
Expert 3 Epoch 5:  10%|▉         | 2/21 [00:01<00:14,  1.33it/s]
Expert 3 Epoch 5:  14%|█▍        | 3/21 [00:02<00:10,  1.74it/s]
Expert 3 Epoch 5:  19%|█▉        | 4/21 [00:02<00:08,  2.04it/s]
Expert 3 Epoch 5:  24%|██▍       | 5/21 [00:02<00:07,  2.24it/s]
Expert 3 Epoch 5:  29%|██▊       | 6/21 [00:03<00:06,  2.39it/s]
Expert 3 Epoch 5:  33%|███▎      | 7/21 [00:03<00:05,  2.49it/s]
Expert 3 Epoch 5:  38%|███▊      | 8/21 [00:03<00:05,  2.56it/s]
Expert 3 Epoch 5:  43%|████▎     | 9/21 [00:04<00:04,  2.60it/s]
Expert 3 Epoch 5:  48%|████▊     | 10/21 [00:04<00:04,  2.63it/s]
Expert 3 Epoch 5:  52%|█████▏    | 11/21 [00:04<00:03,  2.65it/s]
Expert 3 Epoch 5:  57%|█████▋    | 12/21 [00:05<00:03,  2.66it/s]
Expert 3 Epoch 5:  62%|██████▏   | 13/21 [00:05<00:02,  2.67it/s]
Expert 3 Epoch 5:  67%|██████▋   | 14/21 [00:06<00:02,  2.68it/s]
Expert 3 Epoch 5:  71%|███████▏  | 15/21 [00:06<00:02,  2.70it/s]
Expert 3 Epoch 5:  76%|███████▌  | 16/21 [00:06<00:01,  2.71it/s]
Expert 3 Epoch 5:  81%|████████  | 17/21 [00:07<00:01,  2.71it/s]
Expert 3 Epoch 5:  86%|████████▌ | 18/21 [00:07<00:01,  2.72it/s]
Expert 3 Epoch 5:  90%|█████████ | 19/21 [00:07<00:00,  2.71it/s]
Expert 3 Epoch 5:  95%|█████████▌| 20/21 [00:08<00:00,  2.71it/s]
Expert 3 Epoch 5: 100%|██████████| 21/21 [00:08<00:00,  2.84it/s]
                                                                 
/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/utils/data/dataset.py:469: UserWarning: Length of split at index 1 is 0. This might result in an empty dataset.
  warnings.warn(

Expert 4 Epoch 1:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 4 Epoch 1: 100%|██████████| 1/1 [00:01<00:00,  1.32s/it]
                                                               

Expert 4 Epoch 2:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 4 Epoch 2: 100%|██████████| 1/1 [00:01<00:00,  1.13s/it]
                                                               

Expert 4 Epoch 3:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 4 Epoch 3: 100%|██████████| 1/1 [00:01<00:00,  1.15s/it]
                                                               

Expert 4 Epoch 4:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 4 Epoch 4: 100%|██████████| 1/1 [00:01<00:00,  1.25s/it]
                                                               

Expert 4 Epoch 5:   0%|          | 0/1 [00:00<?, ?it/s]
Expert 4 Epoch 5: 100%|██████████| 1/1 [00:01<00:00,  1.17s/it]
                                                               

Expert 5 Epoch 1:   0%|          | 0/22 [00:00<?, ?it/s]
Expert 5 Epoch 1:   5%|▍         | 1/22 [00:01<00:30,  1.45s/it]
Expert 5 Epoch 1:   9%|▉         | 2/22 [00:01<00:16,  1.22it/s]
Expert 5 Epoch 1:  14%|█▎        | 3/22 [00:02<00:11,  1.63it/s]
Expert 5 Epoch 1:  18%|█▊        | 4/22 [00:02<00:09,  1.94it/s]
Expert 5 Epoch 1:  23%|██▎       | 5/22 [00:02<00:07,  2.16it/s]
Expert 5 Epoch 1:  27%|██▋       | 6/22 [00:03<00:06,  2.31it/s]
Expert 5 Epoch 1:  32%|███▏      | 7/22 [00:03<00:06,  2.42it/s]
Expert 5 Epoch 1:  36%|███▋      | 8/22 [00:04<00:05,  2.50it/s]
Expert 5 Epoch 1:  41%|████      | 9/22 [00:04<00:05,  2.56it/s]
Expert 5 Epoch 1:  45%|████▌     | 10/22 [00:04<00:04,  2.60it/s]
Expert 5 Epoch 1:  50%|█████     | 11/22 [00:05<00:04,  2.63it/s]
Expert 5 Epoch 1:  55%|█████▍    | 12/22 [00:05<00:03,  2.65it/s]
Expert 5 Epoch 1:  59%|█████▉    | 13/22 [00:05<00:03,  2.68it/s]
Expert 5 Epoch 1:  64%|██████▎   | 14/22 [00:06<00:02,  2.68it/s]
Expert 5 Epoch 1:  68%|██████▊   | 15/22 [00:06<00:02,  2.69it/s]
Expert 5 Epoch 1:  73%|███████▎  | 16/22 [00:07<00:02,  2.69it/s]
Expert 5 Epoch 1:  77%|███████▋  | 17/22 [00:07<00:01,  2.72it/s]
Expert 5 Epoch 1:  82%|████████▏ | 18/22 [00:07<00:01,  2.73it/s]
Expert 5 Epoch 1:  86%|████████▋ | 19/22 [00:08<00:01,  2.76it/s]
Expert 5 Epoch 1:  91%|█████████ | 20/22 [00:08<00:00,  2.76it/s]
Expert 5 Epoch 1:  95%|█████████▌| 21/22 [00:08<00:00,  2.76it/s]
Expert 5 Epoch 1: 100%|██████████| 22/22 [00:09<00:00,  3.01it/s]
                                                                 

Expert 5 Epoch 2:   0%|          | 0/22 [00:00<?, ?it/s]
Expert 5 Epoch 2:   5%|▍         | 1/22 [00:01<00:26,  1.28s/it]
Expert 5 Epoch 2:   9%|▉         | 2/22 [00:01<00:14,  1.34it/s]
Expert 5 Epoch 2:  14%|█▎        | 3/22 [00:02<00:10,  1.74it/s]
Expert 5 Epoch 2:  18%|█▊        | 4/22 [00:02<00:08,  2.02it/s]
Expert 5 Epoch 2:  23%|██▎       | 5/22 [00:02<00:07,  2.23it/s]
Expert 5 Epoch 2:  27%|██▋       | 6/22 [00:03<00:06,  2.37it/s]
Expert 5 Epoch 2:  32%|███▏      | 7/22 [00:03<00:06,  2.47it/s]
Expert 5 Epoch 2:  36%|███▋      | 8/22 [00:03<00:05,  2.55it/s]
Expert 5 Epoch 2:  41%|████      | 9/22 [00:04<00:05,  2.60it/s]
Expert 5 Epoch 2:  45%|████▌     | 10/22 [00:04<00:04,  2.62it/s]
Expert 5 Epoch 2:  50%|█████     | 11/22 [00:04<00:04,  2.64it/s]
Expert 5 Epoch 2:  55%|█████▍    | 12/22 [00:05<00:03,  2.65it/s]
Expert 5 Epoch 2:  59%|█████▉    | 13/22 [00:05<00:03,  2.66it/s]
Expert 5 Epoch 2:  64%|██████▎   | 14/22 [00:06<00:02,  2.68it/s]
Expert 5 Epoch 2:  68%|██████▊   | 15/22 [00:06<00:02,  2.71it/s]
Expert 5 Epoch 2:  73%|███████▎  | 16/22 [00:06<00:02,  2.72it/s]
Expert 5 Epoch 2:  77%|███████▋  | 17/22 [00:07<00:01,  2.72it/s]
Expert 5 Epoch 2:  82%|████████▏ | 18/22 [00:07<00:01,  2.74it/s]
Expert 5 Epoch 2:  86%|████████▋ | 19/22 [00:07<00:01,  2.72it/s]
Expert 5 Epoch 2:  91%|█████████ | 20/22 [00:08<00:00,  2.72it/s]
Expert 5 Epoch 2:  95%|█████████▌| 21/22 [00:08<00:00,  2.72it/s]
Expert 5 Epoch 2: 100%|██████████| 22/22 [00:08<00:00,  2.94it/s]
                                                                 

Expert 5 Epoch 3:   0%|          | 0/22 [00:00<?, ?it/s]
Expert 5 Epoch 3:   5%|▍         | 1/22 [00:01<00:28,  1.35s/it]
Expert 5 Epoch 3:   9%|▉         | 2/22 [00:01<00:15,  1.31it/s]
Expert 5 Epoch 3:  14%|█▎        | 3/22 [00:02<00:11,  1.72it/s]
Expert 5 Epoch 3:  18%|█▊        | 4/22 [00:02<00:08,  2.03it/s]
Expert 5 Epoch 3:  23%|██▎       | 5/22 [00:02<00:07,  2.24it/s]
Expert 5 Epoch 3:  27%|██▋       | 6/22 [00:03<00:06,  2.40it/s]
Expert 5 Epoch 3:  32%|███▏      | 7/22 [00:03<00:05,  2.51it/s]
Expert 5 Epoch 3:  36%|███▋      | 8/22 [00:03<00:05,  2.58it/s]
Expert 5 Epoch 3:  41%|████      | 9/22 [00:04<00:04,  2.64it/s]
Expert 5 Epoch 3:  45%|████▌     | 10/22 [00:04<00:04,  2.68it/s]
Expert 5 Epoch 3:  50%|█████     | 11/22 [00:04<00:04,  2.71it/s]
Expert 5 Epoch 3:  55%|█████▍    | 12/22 [00:05<00:03,  2.72it/s]
Expert 5 Epoch 3:  59%|█████▉    | 13/22 [00:05<00:03,  2.72it/s]
Expert 5 Epoch 3:  64%|██████▎   | 14/22 [00:06<00:02,  2.74it/s]
Expert 5 Epoch 3:  68%|██████▊   | 15/22 [00:06<00:02,  2.76it/s]
Expert 5 Epoch 3:  73%|███████▎  | 16/22 [00:06<00:02,  2.76it/s]
Expert 5 Epoch 3:  77%|███████▋  | 17/22 [00:07<00:01,  2.76it/s]
Expert 5 Epoch 3:  82%|████████▏ | 18/22 [00:07<00:01,  2.78it/s]
Expert 5 Epoch 3:  86%|████████▋ | 19/22 [00:07<00:01,  2.78it/s]
Expert 5 Epoch 3:  91%|█████████ | 20/22 [00:08<00:00,  2.78it/s]
Expert 5 Epoch 3:  95%|█████████▌| 21/22 [00:08<00:00,  2.76it/s]
Expert 5 Epoch 3: 100%|██████████| 22/22 [00:08<00:00,  2.97it/s]
                                                                 

Expert 5 Epoch 4:   0%|          | 0/22 [00:00<?, ?it/s]
Expert 5 Epoch 4:   5%|▍         | 1/22 [00:01<00:28,  1.37s/it]
Expert 5 Epoch 4:   9%|▉         | 2/22 [00:01<00:15,  1.27it/s]
Expert 5 Epoch 4:  14%|█▎        | 3/22 [00:02<00:11,  1.67it/s]
Expert 5 Epoch 4:  18%|█▊        | 4/22 [00:02<00:09,  1.97it/s]
Expert 5 Epoch 4:  23%|██▎       | 5/22 [00:02<00:07,  2.18it/s]
Expert 5 Epoch 4:  27%|██▋       | 6/22 [00:03<00:06,  2.33it/s]
Expert 5 Epoch 4:  32%|███▏      | 7/22 [00:03<00:06,  2.44it/s]
Expert 5 Epoch 4:  36%|███▋      | 8/22 [00:03<00:05,  2.52it/s]
Expert 5 Epoch 4:  41%|████      | 9/22 [00:04<00:05,  2.56it/s]
Expert 5 Epoch 4:  45%|████▌     | 10/22 [00:04<00:04,  2.60it/s]
Expert 5 Epoch 4:  50%|█████     | 11/22 [00:05<00:04,  2.64it/s]
Expert 5 Epoch 4:  55%|█████▍    | 12/22 [00:05<00:03,  2.65it/s]
Expert 5 Epoch 4:  59%|█████▉    | 13/22 [00:05<00:03,  2.65it/s]
Expert 5 Epoch 4:  64%|██████▎   | 14/22 [00:06<00:03,  2.29it/s]
Expert 5 Epoch 4:  68%|██████▊   | 15/22 [00:06<00:02,  2.42it/s]
Expert 5 Epoch 4:  73%|███████▎  | 16/22 [00:07<00:02,  2.51it/s]
Expert 5 Epoch 4:  77%|███████▋  | 17/22 [00:07<00:01,  2.57it/s]
Expert 5 Epoch 4:  82%|████████▏ | 18/22 [00:07<00:01,  2.62it/s]
Expert 5 Epoch 4:  86%|████████▋ | 19/22 [00:08<00:01,  2.66it/s]
Expert 5 Epoch 4:  91%|█████████ | 20/22 [00:08<00:00,  2.69it/s]
Expert 5 Epoch 4:  95%|█████████▌| 21/22 [00:08<00:00,  2.71it/s]
Expert 5 Epoch 4: 100%|██████████| 22/22 [00:09<00:00,  2.96it/s]
                                                                 

Expert 5 Epoch 5:   0%|          | 0/22 [00:00<?, ?it/s]
Expert 5 Epoch 5:   5%|▍         | 1/22 [00:01<00:27,  1.33s/it]
Expert 5 Epoch 5:   9%|▉         | 2/22 [00:01<00:15,  1.31it/s]
Expert 5 Epoch 5:  14%|█▎        | 3/22 [00:02<00:11,  1.71it/s]
Expert 5 Epoch 5:  18%|█▊        | 4/22 [00:02<00:08,  2.00it/s]
Expert 5 Epoch 5:  23%|██▎       | 5/22 [00:02<00:07,  2.20it/s]
Expert 5 Epoch 5:  27%|██▋       | 6/22 [00:03<00:06,  2.35it/s]
Expert 5 Epoch 5:  32%|███▏      | 7/22 [00:03<00:06,  2.46it/s]
Expert 5 Epoch 5:  36%|███▋      | 8/22 [00:03<00:05,  2.53it/s]
Expert 5 Epoch 5:  41%|████      | 9/22 [00:04<00:05,  2.58it/s]
Expert 5 Epoch 5:  45%|████▌     | 10/22 [00:04<00:04,  2.61it/s]
Expert 5 Epoch 5:  50%|█████     | 11/22 [00:05<00:04,  2.64it/s]
Expert 5 Epoch 5:  55%|█████▍    | 12/22 [00:05<00:03,  2.66it/s]
Expert 5 Epoch 5:  59%|█████▉    | 13/22 [00:05<00:03,  2.67it/s]
Expert 5 Epoch 5:  64%|██████▎   | 14/22 [00:06<00:02,  2.68it/s]
Expert 5 Epoch 5:  68%|██████▊   | 15/22 [00:06<00:02,  2.71it/s]
Expert 5 Epoch 5:  73%|███████▎  | 16/22 [00:06<00:02,  2.71it/s]
Expert 5 Epoch 5:  77%|███████▋  | 17/22 [00:07<00:01,  2.72it/s]
Expert 5 Epoch 5:  82%|████████▏ | 18/22 [00:07<00:01,  2.72it/s]
Expert 5 Epoch 5:  86%|████████▋ | 19/22 [00:07<00:01,  2.71it/s]
Expert 5 Epoch 5:  91%|█████████ | 20/22 [00:08<00:00,  2.72it/s]
Expert 5 Epoch 5:  95%|█████████▌| 21/22 [00:08<00:00,  2.72it/s]
Expert 5 Epoch 5: 100%|██████████| 22/22 [00:08<00:00,  2.95it/s]
                                                                 
2026-01-23 17:13:05 - INFO - [STEP 5/5] Training full ASR model...
/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/train_pipeline.py:445: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=config.fp16)

Training:   0%|          | 0/739 [00:00<?, ?it/s]/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/asr_training.py:314: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=config.fp16):
/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/asr_training.py:344: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=config.fp16):

                                                 
Traceback (most recent call last):
  File "/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/train_pipeline.py", line 1125, in <module>
    run_pipeline(
  File "/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/train_pipeline.py", line 924, in run_pipeline
    _run_asr_training(
  File "/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/train_pipeline.py", line 462, in _run_asr_training
    train_loss = asr_training._train_epoch(
  File "/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/asr_training.py", line 345, in _train_epoch
    outputs = _forward_model(
  File "/pfs/data6/home/ka/ka_stud/ka_uynlv/Speech_Translation/Training_Scripts/asr_training.py", line 206, in _forward_model
    return base_model(**kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/peft/tuners/tuners_utils.py", line 311, in forward
    return self.model.forward(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/transformers/models/whisper/modeling_whisper.py", line 1289, in forward
    outputs = self.model(
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/transformers/models/whisper/modeling_whisper.py", line 1114, in forward
    encoder_outputs = self.encoder(
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/transformers/models/whisper/modeling_whisper.py", line 710, in forward
    layer_outputs = encoder_layer(
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/transformers/modeling_layers.py", line 94, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/transformers/models/whisper/modeling_whisper.py", line 422, in forward
    hidden_states = self.activation_fn(self.fc1(hidden_states))
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ka/ka_stud/ka_uynlv/.conda/envs/whisper-env/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 134, in forward
    return F.linear(input, self.weight, self.bias)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 44.00 MiB. GPU 0 has a total capacity of 39.49 GiB of which 33.25 MiB is free. Including non-PyTorch memory, this process has 39.43 GiB memory in use. Of the allocated memory 37.69 GiB is allocated by PyTorch, and 1.23 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
